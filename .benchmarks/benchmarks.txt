=================
With Marshmallow:
=================

--- RUN 1 ---
70.18s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
65.52s call     tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.60s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.54s call     tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.54s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.54s setup    tests/test_db/test_db_resources.py::test_catalog
0.53s setup    tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.51s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.50s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.50s setup    tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.50s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.50s setup    tests/test_cli.py::test_analysis_csv
0.49s setup    tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.49s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.49s setup    tests/test_db/test_db_resources.py::test_catalog_deleted
0.49s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.49s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.48s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.48s setup    tests/test_api/test_api_checks.py::test_create_check[resource6]
0.47s setup    tests/test_crawl/test_crawl.py::test_excluded_clause
0.47s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.47s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.47s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.47s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.47s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.47s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.47s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.47s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.47s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.47s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.47s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.46s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.46s setup    tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.46s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.46s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.46s setup    tests/test_db/test_db_checks.py::test_delete_check
0.46s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.46s setup    tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.46s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.46s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.45s setup    tests/test_crawl/test_crawl.py::test_no_change_update_check
0.45s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.45s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.45s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.45s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.45s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.45s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.45s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.45s setup    tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.45s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.45s setup    tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.45s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.45s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.45s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.45s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.44s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.44s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.44s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.44s setup    tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.44s setup    tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.43s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.43s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.43s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.43s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.43s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.43s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.43s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.43s setup    tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.43s setup    tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.43s setup    tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.43s setup    tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.43s setup    tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.43s setup    tests/test_cli.py::test_load_catalog_url_has_changed
0.43s setup    tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.43s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.43s setup    tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.43s setup    tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.43s setup    tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.43s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.42s setup    tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.42s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.42s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.42s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.42s setup    tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.42s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.42s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.42s setup    tests/test_crawl/test_crawl.py::test_deleted_check
0.42s setup    tests/test_cli.py::test_purge_checks
0.42s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.42s setup    tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.42s setup    tests/test_api/test_api_resources_exceptions.py::test_get_resources_exceptions
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.42s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.42s setup    tests/test_cli.py::test_purge_csv_tables
0.42s setup    tests/test_api/test_api_checks.py::test_create_check[resource5]
0.42s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.42s setup    tests/test_api/test_api_checks.py::test_create_check[resource0]
0.42s setup    tests/test_api/test_api_checks.py::test_create_check[resource2]
0.42s setup    tests/test_api/test_api_checks.py::test_create_check[resource1]
0.42s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.42s setup    tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.42s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.41s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.41s setup    tests/test_api/test_api_checks.py::test_create_check[resource4]
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.41s setup    tests/test_analysis/test_geojson.py::test_geojson_analysis
0.41s setup    tests/test_api/test_api_checks.py::test_create_check[resource3]
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.41s setup    tests/test_crawl/test_crawl.py::test_analyse_resource
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.41s setup    tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.41s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.41s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.41s setup    tests/test_api/test_api_statuses.py::test_get_stats
0.41s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.41s setup    tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.41s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.40s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.40s setup    tests/test_api/test_api_statuses.py::test_get_crawler_status
0.40s setup    tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.40s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.40s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.40s setup    tests/test_api/test_api_resources.py::test_get_resource
0.40s setup    tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.40s setup    tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.39s setup    tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.39s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.39s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.38s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.37s setup    tests/test_api/test_api_checks.py::test_create_check_wrongly
0.35s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.35s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.35s call     tests/test_cli.py::test_analysis_csv
0.33s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.33s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.32s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.31s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.31s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.30s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.29s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.28s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.26s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.26s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.26s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.24s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.24s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.24s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.23s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.23s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.22s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.21s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.20s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.20s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.20s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.20s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.19s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.19s setup    tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.19s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.19s setup    tests/test_api/test_api_resources.py::test_update_resource
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.19s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.19s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.19s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.19s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.19s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.19s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.19s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.19s setup    tests/test_api/test_api_resources.py::test_create_resource
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.19s setup    tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.19s setup    tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.19s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.19s setup    tests/test_api/test_api_resources.py::test_delete_resource
0.19s setup    tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.19s setup    tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.19s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.19s setup    tests/test_utils/test_compute_checksum_from_file.py::test_compute_checksum_from_file
0.19s setup    tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.19s setup    tests/test_cli.py::test_insert_resource_in_catalog
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.19s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type0]
0.19s setup    tests/test_api/test_api_statuses.py::test_get_health
0.15s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.14s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.14s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.13s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.13s call     tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.13s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.12s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.11s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.10s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.09s call     tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.09s call     tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.09s call     tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.08s call     tests/test_cli.py::test_purge_checks
0.07s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.07s call     tests/test_cli.py::test_purge_csv_tables
0.07s call     tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.07s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.06s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.06s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.06s call     tests/test_db/test_db_resources.py::test_catalog_deleted
0.06s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.05s call     tests/test_cli.py::test_insert_resource_in_catalog
0.05s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.05s call     tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.04s call     tests/test_cli.py::test_load_catalog_url_has_changed
0.04s call     tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.04s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.04s call     tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.04s call     tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.04s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.04s call     tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.04s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.04s call     tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.04s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.04s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.04s call     tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.04s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.03s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.03s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.03s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.03s call     tests/test_crawl/test_crawl.py::test_deleted_check
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.03s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.03s call     tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.03s call     tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.02s call     tests/test_crawl/test_crawl.py::test_no_change_update_check
0.02s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.02s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.02s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource1]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource4]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource6]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.02s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.02s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource3]
0.02s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource5]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource2]
0.02s call     tests/test_crawl/test_crawl.py::test_excluded_clause
0.02s call     tests/test_api/test_api_resources.py::test_create_resource
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.01s call     tests/test_api/test_api_statuses.py::test_get_stats
0.01s call     tests/test_api/test_api_resources.py::test_update_resource
0.01s call     tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.01s teardown tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.01s call     tests/test_api/test_api_resources.py::test_delete_resource
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.01s teardown tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.01s call     tests/test_api/test_api_statuses.py::test_get_crawler_status
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.01s teardown tests/test_api/test_api_resources.py::test_delete_resource
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.01s teardown tests/test_utils/test_compute_checksum_from_file.py::test_compute_checksum_from_file
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.01s call     tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.01s teardown tests/test_cli.py::test_analysis_csv
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource0]
0.01s teardown tests/test_cli.py::test_insert_resource_in_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource1]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource3]
0.01s teardown tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.01s teardown tests/test_db/test_db_resources.py::test_catalog_deleted
0.01s teardown tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource6]
0.01s teardown tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource4]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource2]
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource5]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.01s teardown tests/test_cli.py::test_load_catalog_url_has_changed
0.01s call     tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.01s teardown tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.01s teardown tests/test_db/test_db_resources.py::test_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.01s call     tests/test_db/test_db_checks.py::test_delete_check
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.01s teardown tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.01s teardown tests/test_api/test_api_resources.py::test_update_resource
0.01s teardown tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.01s teardown tests/test_cli.py::test_purge_csv_tables
0.01s teardown tests/test_cli.py::test_purge_checks
0.01s teardown tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_api/test_api_statuses.py::test_get_stats
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.01s teardown tests/test_api/test_api_resources.py::test_create_resource
0.01s teardown tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.01s teardown tests/test_db/test_db_checks.py::test_delete_check
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.01s teardown tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.01s teardown tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.01s teardown tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.01s teardown tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.01s teardown tests/test_api/test_api_resources.py::test_get_resource
0.01s teardown tests/test_api/test_api_checks.py::test_create_check_wrongly
0.01s teardown tests/test_api/test_api_statuses.py::test_get_crawler_status
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_get_resources_exceptions
0.01s teardown tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.01s teardown tests/test_api/test_api_statuses.py::test_get_health
0.01s teardown tests/test_crawl/test_crawl.py::test_no_change_update_check
0.01s call     tests/test_api/test_api_checks.py::test_create_check_wrongly
0.01s teardown tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.01s teardown tests/test_crawl/test_crawl.py::test_analyse_resource
0.01s call     tests/test_api/test_api_resources.py::test_get_resource

(87 durations < 0.005s hidden.  Use -vv to show these durations.)
============================================== short test summary info ===============================================
FAILED tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2] - AssertionError: assert 'geojson' in 'json'


--- RUN 2 ---
60.45s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
56.88s call     tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis


--- RUN 3 ---
60.17s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
55.12s call     tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.58s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.55s call     tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.52s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.51s setup    tests/test_api/test_api_checks.py::test_create_check[resource2]
0.51s setup    tests/test_crawl/test_crawl.py::test_deleted_check
0.49s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.48s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.48s setup    tests/test_api/test_api_checks.py::test_create_check[resource1]
0.47s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.47s setup    tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.47s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.47s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.47s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.46s setup    tests/test_db/test_db_resources.py::test_catalog_deleted
0.46s setup    tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.46s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.46s setup    tests/test_db/test_db_resources.py::test_catalog
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.46s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.46s setup    tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.46s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.46s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.46s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.46s setup    tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.45s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.45s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.45s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.45s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.45s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.45s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.45s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.44s setup    tests/test_crawl/test_crawl.py::test_no_change_update_check
0.44s setup    tests/test_db/test_db_checks.py::test_delete_check
0.44s setup    tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.44s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.44s setup    tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.44s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.44s setup    tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.44s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.44s setup    tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.44s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.44s setup    tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.44s setup    tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.44s setup    tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.44s setup    tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.44s setup    tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.44s setup    tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.44s setup    tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.43s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.43s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.43s setup    tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.43s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.43s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.43s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.43s setup    tests/test_cli.py::test_analysis_csv
0.43s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.42s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.42s setup    tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.42s setup    tests/test_cli.py::test_load_catalog_url_has_changed
0.42s setup    tests/test_crawl/test_crawl.py::test_excluded_clause
0.42s setup    tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.42s setup    tests/test_api/test_api_checks.py::test_create_check[resource5]
0.42s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.42s setup    tests/test_cli.py::test_purge_csv_tables
0.42s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.42s setup    tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.42s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.42s setup    tests/test_api/test_api_checks.py::test_create_check[resource4]
0.42s setup    tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.42s setup    tests/test_crawl/test_crawl.py::test_analyse_resource
0.42s setup    tests/test_cli.py::test_purge_checks
0.42s setup    tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.42s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.42s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.42s setup    tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.42s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.41s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.41s setup    tests/test_api/test_api_checks.py::test_create_check[resource6]
0.41s setup    tests/test_analysis/test_geojson.py::test_geojson_analysis
0.41s setup    tests/test_api/test_api_checks.py::test_create_check[resource0]
0.41s setup    tests/test_api/test_api_resources_exceptions.py::test_get_resources_exceptions
0.41s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.41s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.41s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.41s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.41s setup    tests/test_api/test_api_checks.py::test_create_check[resource3]
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.40s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.40s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.40s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.40s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.40s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.40s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.40s setup    tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.40s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.40s setup    tests/test_api/test_api_statuses.py::test_get_stats
0.40s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.40s setup    tests/test_api/test_api_statuses.py::test_get_crawler_status
0.40s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.40s setup    tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.40s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.40s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.40s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.40s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.40s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.40s setup    tests/test_api/test_api_resources.py::test_get_resource
0.39s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.39s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.39s setup    tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.39s setup    tests/test_api/test_api_checks.py::test_create_check_wrongly
0.39s setup    tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.39s setup    tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.39s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.39s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.38s setup    tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.38s setup    tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.38s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.38s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.37s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.37s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.37s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.37s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.37s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.37s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.36s call     tests/test_cli.py::test_analysis_csv
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.35s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.31s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.31s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.30s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.29s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.29s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.27s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.27s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.27s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.27s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.27s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.26s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.26s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.24s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.23s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.23s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.23s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.22s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.21s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.20s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.20s setup    tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.20s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.19s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.19s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.19s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.19s setup    tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.19s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.19s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.19s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.19s setup    tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.19s setup    tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.19s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.19s setup    tests/test_api/test_api_resources.py::test_update_resource
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.19s setup    tests/test_utils/test_compute_checksum_from_file.py::test_compute_checksum_from_file
0.19s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.19s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.19s setup    tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.19s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.19s setup    tests/test_cli.py::test_insert_resource_in_catalog
0.19s setup    tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.19s setup    tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.19s setup    tests/test_api/test_api_resources.py::test_delete_resource
0.19s setup    tests/test_api/test_api_resources.py::test_create_resource
0.19s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.19s setup    tests/test_api/test_api_statuses.py::test_get_health
0.18s setup    tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.18s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.18s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type0]
0.18s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.17s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.13s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.13s call     tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.12s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.11s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.11s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.11s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.11s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.11s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.11s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.10s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.10s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.10s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.10s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.10s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.10s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.08s call     tests/test_cli.py::test_purge_checks
0.08s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.08s call     tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.08s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.08s call     tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.08s call     tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.07s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.07s call     tests/test_cli.py::test_purge_csv_tables
0.07s call     tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.07s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.06s call     tests/test_db/test_db_resources.py::test_catalog_deleted
0.06s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.05s call     tests/test_cli.py::test_insert_resource_in_catalog
0.04s call     tests/test_crawl/test_crawl.py::test_deleted_check
0.04s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.04s call     tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.04s call     tests/test_cli.py::test_load_catalog_url_has_changed
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.04s call     tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.04s call     tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.04s call     tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.04s call     tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.04s call     tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.04s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.04s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.04s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.04s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.04s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.03s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.03s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.03s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.03s call     tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.03s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.03s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.03s call     tests/test_api/test_api_checks.py::test_create_check[resource2]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.03s call     tests/test_api/test_api_checks.py::test_create_check[resource1]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.03s call     tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.03s call     tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.02s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.02s call     tests/test_crawl/test_crawl.py::test_no_change_update_check
0.02s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.02s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.02s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource4]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource5]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource6]
0.02s call     tests/test_crawl/test_crawl.py::test_excluded_clause
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource3]
0.02s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.01s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.01s call     tests/test_api/test_api_statuses.py::test_get_stats
0.01s teardown tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource
0.01s call     tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s call     tests/test_api/test_api_resources.py::test_update_resource
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.01s call     tests/test_api/test_api_statuses.py::test_get_crawler_status
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.01s teardown tests/test_utils/test_compute_checksum_from_file.py::test_compute_checksum_from_file
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.01s call     tests/test_api/test_api_resources.py::test_create_resource
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource1]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.01s call     tests/test_api/test_api_resources.py::test_delete_resource
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.01s teardown tests/test_api/test_api_statuses.py::test_get_health
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.01s teardown tests/test_cli.py::test_analysis_csv
0.01s call     tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.01s teardown tests/test_api/test_api_resources.py::test_delete_resource
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource2]
0.01s teardown tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.01s teardown tests/test_api/test_api_resources.py::test_create_resource
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource6]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.01s teardown tests/test_cli.py::test_insert_resource_in_catalog
0.01s teardown tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource3]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.01s teardown tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource4]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type0]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource5]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.01s teardown tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.01s teardown tests/test_cli.py::test_purge_checks
0.01s teardown tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s teardown tests/test_db/test_db_resources.py::test_catalog
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s teardown tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.01s call     tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.01s teardown tests/test_cli.py::test_load_catalog_url_has_changed
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.01s teardown tests/test_db/test_db_resources.py::test_catalog_deleted
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.01s call     tests/test_db/test_db_checks.py::test_delete_check
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.01s teardown tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_cli.py::test_purge_csv_tables
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.01s teardown tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_get_resources_exceptions
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.01s teardown tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.01s teardown tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check_wrongly
0.01s teardown tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_api/test_api_resources.py::test_get_resource
0.01s teardown tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.01s teardown tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.01s teardown tests/test_api/test_api_statuses.py::test_get_stats
0.01s call     tests/test_api/test_api_checks.py::test_create_check_wrongly
0.01s teardown tests/test_api/test_api_resources.py::test_update_resource
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.01s teardown tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.01s teardown tests/test_crawl/test_crawl.py::test_no_change_update_check
0.01s call     tests/test_api/test_api_resources.py::test_get_resource
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.01s teardown tests/test_api/test_api_statuses.py::test_get_crawler_status
0.01s teardown tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.01s teardown tests/test_crawl/test_crawl.py::test_analyse_resource
0.01s teardown tests/test_db/test_db_checks.py::test_delete_check

(87 durations < 0.005s hidden.  Use -vv to show these durations.)
============================================== short test summary info ===============================================
FAILED tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2] - AssertionError: assert 'geojson' in 'json'


=================
With Pydantic:
=================

--- RUN 1 ---
26.19s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
25.38s call     tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
2.50s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.59s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.56s call     tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.46s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.46s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.46s setup    tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.45s setup    tests/test_db/test_db_resources.py::test_catalog
0.42s setup    tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.41s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.40s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.40s setup    tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.40s setup    tests/test_api/test_api_statuses.py::test_get_crawler_status
0.39s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.39s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.39s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.39s setup    tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.38s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.38s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.38s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.38s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.38s setup    tests/test_db/test_db_resources.py::test_catalog_deleted
0.38s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.38s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.38s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.38s setup    tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.38s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.38s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.38s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.38s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.37s setup    tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.37s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.37s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.37s setup    tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.37s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.37s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.37s setup    tests/test_cli.py::test_purge_checks
0.37s setup    tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.37s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.37s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.37s setup    tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.37s setup    tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.37s setup    tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.37s setup    tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.37s setup    tests/test_analysis/test_geojson.py::test_geojson_analysis
0.37s setup    tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.36s setup    tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.36s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.36s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.36s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.36s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.36s setup    tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.36s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.36s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.36s setup    tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.36s setup    tests/test_db/test_db_checks.py::test_delete_check
0.36s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.36s setup    tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.36s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.36s setup    tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.36s setup    tests/test_crawl/test_crawl.py::test_no_change_update_check
0.36s setup    tests/test_cli.py::test_analysis_csv
0.36s setup    tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.36s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.36s setup    tests/test_cli.py::test_purge_csv_tables
0.36s setup    tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.36s setup    tests/test_cli.py::test_load_catalog_url_has_changed
0.36s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.36s setup    tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.35s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.35s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.35s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.35s setup    tests/test_api/test_api_checks.py::test_create_check[resource2]
0.35s setup    tests/test_crawl/test_crawl.py::test_analyse_resource
0.35s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.35s setup    tests/test_api/test_api_checks.py::test_create_check[resource5]
0.35s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.35s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.35s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.35s setup    tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.35s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.35s setup    tests/test_api/test_api_checks.py::test_create_check[resource3]
0.35s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.35s setup    tests/test_api/test_api_checks.py::test_create_check[resource1]
0.35s setup    tests/test_api/test_api_checks.py::test_create_check[resource6]
0.35s setup    tests/test_api/test_api_checks.py::test_create_check[resource0]
0.35s setup    tests/test_crawl/test_crawl.py::test_deleted_check
0.35s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.35s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.35s setup    tests/test_api/test_api_checks.py::test_create_check[resource4]
0.35s setup    tests/test_api/test_api_statuses.py::test_get_stats
0.34s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.34s setup    tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.34s setup    tests/test_crawl/test_crawl.py::test_excluded_clause
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.34s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.34s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.34s setup    tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.34s setup    tests/test_api/test_api_resources_exceptions.py::test_get_resources_exceptions
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.34s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.34s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.34s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.34s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.34s setup    tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.34s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.33s setup    tests/test_api/test_api_resources.py::test_get_resource
0.33s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.33s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.33s setup    tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.33s setup    tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.33s setup    tests/test_api/test_api_checks.py::test_create_check_wrongly
0.33s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.33s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.33s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.33s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.33s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.32s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.32s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.32s setup    tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.32s setup    tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.31s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.29s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.29s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.22s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.22s call     tests/test_cli.py::test_analysis_csv
0.20s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.19s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.19s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.18s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.18s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.17s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.17s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.17s setup    tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.17s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.17s setup    tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.17s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.17s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.17s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.17s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.17s setup    tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.17s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.17s setup    tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.17s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.17s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.16s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.16s setup    tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.16s setup    tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.16s setup    tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.16s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.16s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.16s setup    tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.16s setup    tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.16s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.16s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.16s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.16s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.16s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.16s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.16s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.16s setup    tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.16s setup    tests/test_api/test_api_resources.py::test_update_resource
0.16s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.16s setup    tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.16s setup    tests/test_api/test_api_resources.py::test_create_resource
0.16s setup    tests/test_cli.py::test_insert_resource_in_catalog
0.16s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.16s setup    tests/test_api/test_api_statuses.py::test_get_health
0.16s setup    tests/test_api/test_api_resources.py::test_delete_resource
0.15s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.15s setup    tests/test_utils/test_compute_checksum_from_file.py::test_compute_checksum_from_file
0.15s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type0]
0.15s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.14s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.14s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.14s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.14s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.13s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.13s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.12s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.11s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.11s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.10s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.10s call     tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.08s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.08s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.08s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.07s call     tests/test_cli.py::test_purge_checks
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.06s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.06s call     tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.06s call     tests/test_cli.py::test_purge_csv_tables
0.06s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.06s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.06s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.05s call     tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.05s call     tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.05s call     tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.05s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.04s call     tests/test_db/test_db_resources.py::test_catalog_deleted
0.04s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.04s call     tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.04s call     tests/test_cli.py::test_insert_resource_in_catalog
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.04s call     tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.04s call     tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.04s call     tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.04s call     tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.03s call     tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.03s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.03s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.03s call     tests/test_cli.py::test_load_catalog_url_has_changed
0.03s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.03s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.03s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.03s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.03s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.03s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.03s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.03s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.03s call     tests/test_crawl/test_crawl.py::test_deleted_check
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.03s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.03s call     tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.03s call     tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.02s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.02s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.02s call     tests/test_crawl/test_crawl.py::test_no_change_update_check
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.02s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource1]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource0]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource2]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource3]
0.02s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource4]
0.02s call     tests/test_crawl/test_crawl.py::test_excluded_clause
0.02s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.01s call     tests/test_api/test_api_checks.py::test_create_check[resource6]
0.01s call     tests/test_api/test_api_checks.py::test_create_check[resource5]
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource
0.01s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.01s call     tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s call     tests/test_api/test_api_statuses.py::test_get_stats
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.01s call     tests/test_api/test_api_statuses.py::test_get_crawler_status
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.01s call     tests/test_api/test_api_resources.py::test_update_resource
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.01s teardown tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s call     tests/test_api/test_api_resources.py::test_delete_resource
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.01s call     tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.01s teardown tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s call     tests/test_db/test_db_checks.py::test_delete_check
0.01s teardown tests/test_db/test_db_resources.py::test_catalog_deleted
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource1]
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource3]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource5]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource2]
0.01s teardown tests/test_cli.py::test_analysis_csv
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.01s call     tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource6]
0.01s teardown tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource0]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.01s teardown tests/test_cli.py::test_load_catalog_url_has_changed
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.01s teardown tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.01s call     tests/test_api/test_api_resources.py::test_create_resource
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s teardown tests/test_cli.py::test_purge_csv_tables
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.01s teardown tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.01s teardown tests/test_cli.py::test_purge_checks
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.01s teardown tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.01s teardown tests/test_utils/test_compute_checksum_from_file.py::test_compute_checksum_from_file
0.01s teardown tests/test_db/test_db_resources.py::test_catalog

(118 durations < 0.005s hidden.  Use -vv to show these durations.)
============================================== short test summary info ===============================================
FAILED tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2] - AssertionError: assert 'geojson' in 'json'


--- RUN 2 ---
22.09s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
21.61s call     tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
5.26s setup    tests/test_api/test_api_checks.py::test_create_check[resource5]
2.10s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.57s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.53s call     tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.45s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.42s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.42s setup    tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.42s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.41s setup    tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.41s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.40s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.40s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.39s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.39s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.39s setup    tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.38s setup    tests/test_api/test_api_checks.py::test_create_check[resource2]
0.37s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.37s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.37s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.37s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.36s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.36s setup    tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.36s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.36s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.36s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.35s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.35s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.35s setup    tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.35s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.35s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.35s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.35s setup    tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.35s setup    tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.35s setup    tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.34s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.34s setup    tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.34s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.34s setup    tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.34s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.34s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.34s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.34s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.34s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.34s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.34s setup    tests/test_db/test_db_resources.py::test_catalog
0.34s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.34s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.34s setup    tests/test_crawl/test_crawl.py::test_analyse_resource
0.34s setup    tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.34s setup    tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.34s setup    tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.34s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.34s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.34s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.34s setup    tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.34s setup    tests/test_db/test_db_resources.py::test_catalog_deleted
0.34s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.33s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.33s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.33s setup    tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.33s setup    tests/test_cli.py::test_load_catalog_url_has_changed
0.33s setup    tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.33s setup    tests/test_cli.py::test_analysis_csv
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.33s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.33s setup    tests/test_analysis/test_geojson.py::test_geojson_analysis
0.33s setup    tests/test_crawl/test_crawl.py::test_excluded_clause
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.33s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.33s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.33s setup    tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.33s setup    tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.33s setup    tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.33s setup    tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.33s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.33s setup    tests/test_cli.py::test_purge_checks
0.32s setup    tests/test_crawl/test_crawl.py::test_no_change_update_check
0.32s setup    tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.32s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.32s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.32s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.32s setup    tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.32s setup    tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.32s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.32s setup    tests/test_cli.py::test_purge_csv_tables
0.32s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.32s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.32s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.32s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.32s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.32s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.32s setup    tests/test_db/test_db_checks.py::test_delete_check
0.32s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.32s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.32s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.32s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.32s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.31s setup    tests/test_api/test_api_checks.py::test_create_check[resource6]
0.31s setup    tests/test_api/test_api_checks.py::test_create_check[resource1]
0.31s setup    tests/test_api/test_api_resources_exceptions.py::test_get_resources_exceptions
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.31s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.31s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.31s setup    tests/test_api/test_api_checks.py::test_create_check[resource0]
0.31s setup    tests/test_api/test_api_checks.py::test_create_check[resource3]
0.31s setup    tests/test_api/test_api_statuses.py::test_get_stats
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.31s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.31s setup    tests/test_crawl/test_crawl.py::test_deleted_check
0.31s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.31s setup    tests/test_api/test_api_checks.py::test_create_check[resource4]
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.30s setup    tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.30s setup    tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.30s setup    tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.30s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.30s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.30s setup    tests/test_api/test_api_statuses.py::test_get_crawler_status
0.30s setup    tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.29s setup    tests/test_api/test_api_resources.py::test_get_resource
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.29s setup    tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.29s setup    tests/test_api/test_api_checks.py::test_create_check_wrongly
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.28s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.25s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.21s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.19s call     tests/test_cli.py::test_analysis_csv
0.19s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.18s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.18s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.17s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.17s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.17s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.17s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.16s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.15s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.14s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.14s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.14s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.14s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.14s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.14s setup    tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.14s setup    tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.14s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.14s setup    tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.14s setup    tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.14s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.14s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.14s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.14s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.14s setup    tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.14s setup    tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.14s setup    tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.14s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.13s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.13s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.13s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.13s setup    tests/test_cli.py::test_insert_resource_in_catalog
0.13s setup    tests/test_api/test_api_resources.py::test_update_resource
0.13s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type0]
0.13s setup    tests/test_api/test_api_statuses.py::test_get_health
0.13s setup    tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.13s setup    tests/test_api/test_api_resources.py::test_create_resource
0.13s setup    tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.13s setup    tests/test_api/test_api_resources.py::test_delete_resource
0.13s setup    tests/test_utils/test_compute_checksum_from_file.py::test_compute_checksum_from_file
0.12s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.11s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.11s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.11s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.11s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.11s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.10s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.09s call     tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.09s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.08s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.07s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.07s call     tests/test_cli.py::test_purge_checks
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.06s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.06s call     tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.06s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.06s call     tests/test_cli.py::test_purge_csv_tables
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.05s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.05s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.05s call     tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.05s call     tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.05s call     tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.05s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.04s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.04s call     tests/test_db/test_db_resources.py::test_catalog_deleted
0.04s call     tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.04s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.04s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.04s call     tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.04s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.04s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.03s call     tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.03s call     tests/test_cli.py::test_insert_resource_in_catalog
0.03s call     tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.03s call     tests/test_cli.py::test_load_catalog_url_has_changed
0.03s call     tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.03s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.03s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.03s call     tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.03s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.03s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.03s call     tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.03s call     tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.03s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.03s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.03s call     tests/test_crawl/test_crawl.py::test_deleted_check
0.03s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.03s call     tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.03s call     tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.03s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.02s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.02s call     tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.02s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.02s call     tests/test_crawl/test_crawl.py::test_no_change_update_check
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.02s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource4]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_excluded_clause
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource1]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource2]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.02s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource3]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource0]
0.02s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.01s call     tests/test_api/test_api_checks.py::test_create_check[resource6]
0.01s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource
0.01s call     tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.01s call     tests/test_api/test_api_checks.py::test_create_check[resource5]
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.01s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.01s call     tests/test_api/test_api_statuses.py::test_get_stats
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.01s call     tests/test_api/test_api_statuses.py::test_get_crawler_status
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.01s call     tests/test_api/test_api_resources.py::test_update_resource
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.01s teardown tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource4]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.01s call     tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource3]
0.01s call     tests/test_api/test_api_resources.py::test_delete_resource
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.01s call     tests/test_db/test_db_checks.py::test_delete_check
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource6]
0.01s teardown tests/test_cli.py::test_purge_csv_tables
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource1]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource5]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.01s teardown tests/test_db/test_db_resources.py::test_catalog
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.01s teardown tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.01s call     tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.01s teardown tests/test_cli.py::test_analysis_csv
0.01s teardown tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.01s teardown tests/test_cli.py::test_purge_checks
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.01s teardown tests/test_cli.py::test_load_catalog_url_has_changed
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.01s teardown tests/test_api/test_api_statuses.py::test_get_stats
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.01s teardown tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.01s call     tests/test_api/test_api_resources.py::test_create_resource
0.01s teardown tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.01s teardown tests/test_db/test_db_resources.py::test_catalog_deleted

(123 durations < 0.005s hidden.  Use -vv to show these durations.)
============================================== short test summary info ===============================================
FAILED tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2] - AssertionError: assert 'geojson' in 'json'


--- RUN 3 ---
21.56s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
21.42s call     tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
5.29s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
1.13s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.60s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.55s call     tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.42s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.40s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.38s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.37s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.37s setup    tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.37s setup    tests/test_crawl/test_crawl.py::test_deleted_check
0.37s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.36s setup    tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.36s setup    tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.35s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.35s setup    tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.35s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.35s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.35s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.35s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.35s setup    tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.35s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.35s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.35s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.34s setup    tests/test_analysis/test_geojson.py::test_geojson_analysis
0.34s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.34s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.34s setup    tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.34s setup    tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.34s setup    tests/test_api/test_api_checks.py::test_create_check[resource3]
0.34s setup    tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.34s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.34s setup    tests/test_api/test_api_checks.py::test_create_check[resource6]
0.34s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.34s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.34s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.33s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.33s setup    tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.33s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.33s setup    tests/test_db/test_db_resources.py::test_catalog
0.33s setup    tests/test_db/test_db_resources.py::test_catalog_deleted
0.33s setup    tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.33s setup    tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.33s setup    tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.33s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.33s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.33s setup    tests/test_api/test_api_checks.py::test_create_check[resource4]
0.32s setup    tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.32s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.32s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.32s setup    tests/test_crawl/test_crawl.py::test_no_change_update_check
0.32s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.32s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.32s setup    tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.32s setup    tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.32s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.32s setup    tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.32s setup    tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.32s setup    tests/test_cli.py::test_analysis_csv
0.32s setup    tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.32s setup    tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.32s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.32s setup    tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.32s setup    tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.32s setup    tests/test_api/test_api_checks.py::test_create_check[resource5]
0.32s setup    tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.32s setup    tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.32s setup    tests/test_db/test_db_checks.py::test_delete_check
0.32s setup    tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.31s setup    tests/test_crawl/test_crawl.py::test_analyse_resource
0.31s setup    tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.31s setup    tests/test_cli.py::test_purge_checks
0.31s setup    tests/test_api/test_api_checks.py::test_create_check[resource0]
0.31s setup    tests/test_cli.py::test_load_catalog_url_has_changed
0.31s setup    tests/test_api/test_api_checks.py::test_create_check[resource2]
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.31s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.31s setup    tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.31s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.31s setup    tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.31s setup    tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.31s setup    tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.31s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.31s setup    tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.31s setup    tests/test_api/test_api_resources_exceptions.py::test_get_resources_exceptions
0.31s setup    tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.31s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.30s setup    tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.30s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.30s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.30s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.30s setup    tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.30s setup    tests/test_cli.py::test_purge_csv_tables
0.30s setup    tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.30s setup    tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.30s setup    tests/test_crawl/test_crawl.py::test_excluded_clause
0.30s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.30s setup    tests/test_api/test_api_checks.py::test_create_check[resource1]
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.30s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.30s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.30s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.30s setup    tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.30s setup    tests/test_api/test_api_resources.py::test_get_resource
0.30s setup    tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.29s setup    tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.29s setup    tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.29s setup    tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.29s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.29s setup    tests/test_api/test_api_resources_exceptions.py::test_delete_resource_exception
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.29s setup    tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.29s setup    tests/test_api/test_api_checks.py::test_create_check_wrongly
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.29s setup    tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.29s setup    tests/test_api/test_api_statuses.py::test_get_crawler_status
0.29s setup    tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.29s setup    tests/test_api/test_api_statuses.py::test_get_stats
0.29s setup    tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.28s setup    tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.28s setup    tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.28s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.27s setup    tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.26s setup    tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.26s setup    tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.25s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.24s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.21s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.20s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_checked_resource
0.19s call     tests/test_cli.py::test_analysis_csv
0.19s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.17s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.15s setup    tests/test_utils/test_compute_checksum_from_file.py::test_compute_checksum_from_file
0.15s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[True]
0.15s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.14s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.14s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.14s setup    tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.14s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.14s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.14s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.14s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.14s call     tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.14s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.14s setup    tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.14s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.14s setup    tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.14s setup    tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.14s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.14s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.14s setup    tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.14s setup    tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.14s setup    tests/test_api/test_api_resources.py::test_create_resource
0.14s setup    tests/test_cli.py::test_insert_resource_in_catalog
0.13s setup    tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.13s call     tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.13s setup    tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.13s setup    tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.13s setup    tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.13s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type0]
0.13s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.13s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.13s setup    tests/test_api/test_api_resources.py::test_update_resource
0.13s setup    tests/test_api/test_api_statuses.py::test_get_health
0.13s setup    tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.13s setup    tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.13s setup    tests/test_api/test_api_resources.py::test_delete_resource
0.13s setup    tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.12s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.12s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config1]
0.12s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.12s call     tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.11s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.11s call     tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.10s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.10s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.09s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.09s call     tests/test_crawl/test_crawl.py::test_check_triggers_csv_analysis
0.09s call     tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.08s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected0]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected3]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.06s call     tests/test_cli.py::test_purge_checks
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.06s call     tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.05s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_deleted_resource_only
0.05s call     tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.05s call     tests/test_cli.py::test_purge_csv_tables
0.05s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=domain&created_at=today-{0}.com]
0.05s call     tests/test_api/test_api_checks.py::test_api_get_checks_aggregate[group_by=headers->>'content-type'&created_at=2024-09-05-application/{0}]
0.05s call     tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.05s call     tests/test_analysis/test_analysis_csv.py::test_reserved_column_name
0.05s call     tests/test_analysis/test_analysis_csv.py::test_percentage_column
0.05s call     tests/test_analysis/test_analysis_csv.py::test_basic_sql_injection
0.04s call     tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.04s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit4]
0.04s call     tests/test_db/test_db_resources.py::test_catalog_deleted
0.04s call     tests/test_db/test_db_resources.py::test_catalog_deleted_with_new_url
0.04s call     tests/test_cli.py::test_load_catalog_url_has_changed
0.04s call     tests/test_cli.py::test_insert_resource_in_catalog
0.04s call     tests/test_crawl/test_crawl.py::test_change_analysis_harvested
0.04s call     tests/test_crawl/test_crawl.py::test_recheck_download_only_once
0.04s call     tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.03s call     tests/test_crawl/test_crawl.py::test_change_analysis_checksum
0.03s call     tests/test_crawl/test_crawl.py::test_change_analysis_content_length_header
0.03s call     tests/test_crawl/test_crawl.py::test_check_changed_content_type_header
0.03s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice_tz
0.03s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header
0.03s call     tests/test_crawl/test_crawl.py::test_check_changed_content_length_header
0.03s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit3]
0.03s call     tests/test_crawl/test_crawl.py::test_analyse_resource_from_crawl
0.03s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get
0.03s call     tests/test_crawl/test_crawl.py::test_change_analysis_last_modified_header_twice
0.03s call     tests/test_crawl/test_crawl.py::test_no_change_analysis_harvested
0.03s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit2]
0.03s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_type_header
0.03s call     tests/test_crawl/test_crawl.py::test_switch_head_to_get_headers
0.03s call     tests/test_crawl/test_crawl.py::test_crawl_and_analysis_user_agent
0.03s call     tests/test_crawl/test_crawl.py::test_no_check_changed_content_length_header
0.03s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_existing_catalog
0.03s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.03s call     tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.03s call     tests/test_crawl/test_crawl.py::test_deleted_check
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params1]
0.03s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params2]
0.02s call     tests/test_crawl/test_crawl.py::test_check_triggered_by_udata_entrypoint_clean_catalog
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource1]
0.02s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function1]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource2]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource6]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None0]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource4]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource5]
0.02s call     tests/test_crawl/test_crawl.py::test_crawl[resource3]
0.02s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[None1]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_cooled_off
0.02s call     tests/test_crawl/test_backoff.py::test_no_backoff_domains
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[BACKOFF]
0.02s call     tests/test_crawl/test_crawl.py::test_no_switch_head_to_get
0.02s call     tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.02s call     tests/test_crawl/test_crawl.py::test_next_check[last_check_params3]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_nb_req
0.02s call     tests/test_crawl/test_crawl.py::test_new_resource_priority[mock_function0]
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit0]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[INSERTING_IN_DB]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_no_change_update_check
0.02s call     tests/test_crawl/test_backoff.py::test_backoff_rate_limiting[ratelimit1]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource3]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[VALIDATING_CSV]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource5]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PMTILES]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_DOWNLOADED_RESOURCE]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_RESOURCE_HEAD]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_CSV]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[ANALYSING_GEOJSON]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CRAWLING_URL]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_CSV]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_nb_req_lifted
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource0]
0.02s teardown tests/test_crawl/test_backoff.py::test_backoff_on_429_status_code
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_PARQUET]
0.02s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[DOWNLOADING_RESOURCE]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource1]
0.02s call     tests/test_api/test_api_checks.py::test_create_check[resource6]
0.01s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[CONVERTING_TO_GEOJSON]
0.01s call     tests/test_crawl/test_crawl.py::test_dont_check_resources_with_status[TO_ANALYSE_GEOJSON]
0.01s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.01s teardown tests/test_crawl/test_backoff.py::test_backoff_rate_limiting_lifted
0.01s call     tests/test_crawl/test_crawl.py::test_excluded_clause
0.01s call     tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s call     tests/test_api/test_api_checks.py::test_create_check[resource2]
0.01s call     tests/test_api/test_api_checks.py::test_create_check[resource4]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params4]
0.01s call     tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_invalid_geometry
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata_no_change
0.01s call     tests/test_crawl/test_crawl.py::test_analyse_resource_send_udata
0.01s call     tests/test_api/test_api_statuses.py::test_get_stats
0.01s call     tests/test_crawl/test_crawl.py::test_wrong_url_in_catalog[False]
0.01s teardown tests/test_utils/test_sentry_error.py::test_sentry_auto_with_raise_from
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count0]
0.01s call     tests/test_api/test_api_checks.py::test_get_latest_check[url=https://example.com/resource-1]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args1]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args4]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args3]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_to_pmtiles_valid_geometry
0.01s call     tests/test_api/test_api_statuses.py::test_get_crawler_status
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args1]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_save_as_parquet[file_and_count2]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args3]
0.01s call     tests/test_api/test_api_resources.py::test_update_resource
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args0]
0.01s teardown tests/test_analysis/test_parquet_export.py::test_csv_to_parquet[parquet_config0]
0.01s call     tests/test_api/test_api_resources_exceptions.py::test_update_resource_exception
0.01s teardown tests/test_cli.py::test_load_catalog_url_has_changed
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args4]
0.01s call     tests/test_analysis/test_geojson.py::test_analyse_geojson_disabled
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args1]
0.01s call     tests/test_api/test_api_resources.py::test_delete_resource
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params5]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource5]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type1]
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[resource_id=c4e3a9fb-4415-488e-ba57-d05269b27adf]
0.01s call     tests/test_api/test_api_checks.py::test_get_all_checks[url=https://example.com/resource-1]
0.01s teardown tests/test_crawl/test_crawl.py::test_content_type_from_header[content_type2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args2]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args3]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource3]
0.01s teardown tests/test_cli.py::test_load_catalog_harvest_modified_at_has_changed
0.01s call     tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s teardown tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s call     tests/test_db/test_db_checks.py::test_delete_check
0.01s teardown tests/test_analysis/test_change_detections.py::test_content_length_header[args3]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis1]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource6]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args0]
0.01s teardown tests/test_analysis/test_analysis_csv_exceptions.py::test_exception_analysis
0.01s teardown tests/test_analysis/test_change_detections.py::test_checksum[args0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params0]
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_last_modified_header[args1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_parsing
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params3]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource2]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_big_file
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_forced_analysis[forced_analysis0]
0.01s teardown tests/test_analysis/test_change_detections.py::test_harvest[args2]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource4]
0.01s teardown tests/test_cli.py::test_analysis_csv
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[True]
0.01s call     tests/test_api/test_api_resources.py::test_update_resource_url_since_load_catalog
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected2]
0.01s teardown tests/test_api/test_api_checks.py::test_create_check[resource1]
0.01s call     tests/test_api/test_api_resources.py::test_create_resource
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected5]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params3]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected4]
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[7200]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params1]
0.01s teardown tests/test_cli.py::test_purge_checks
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_on_catalog[False]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_simple_type_casting[line_expected1]
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params4]
0.01s teardown tests/test_api/test_api_resources_exceptions.py::test_create_resource_exception
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params0]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected0]
0.01s teardown tests/test_analysis/test_geojson.py::test_geojson_analysis
0.01s teardown tests/test_cli.py::test_purge_selected_csv_tables[_kwargs1]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_error_reporting_csv_detective
0.01s teardown tests/test_crawl/test_crawl.py::test_reset_statuses[1800]
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_used_by_other_resource
0.01s teardown tests/test_cli.py::test_purge_csv_tables_url_not_in_catalog
0.01s teardown tests/test_analysis/test_analysis_other_formats.py::test_formats_analysis[file_and_count2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_analyse_csv_send_udata_webhook
0.01s teardown tests/test_api/test_api_resources.py::test_get_resource
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_validation[_params2]
0.01s teardown tests/test_analysis/test_analysis_csv.py::test_csv_to_db_complex_type_casting[line_expected1]

(128 durations < 0.005s hidden.  Use -vv to show these durations.)
========================================================================================================== short test summary info ==========================================================================================================
FAILED tests/test_analysis/test_analysis_csv.py::test_csv_to_geojson_pmtiles[params2] - AssertionError: assert 'geojson' in 'json'
